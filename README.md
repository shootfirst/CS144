# CS144 斯坦福2021秋季计算机网络实验

## lab1

实验一是实现一字节流重组器，将失序的字节流小块按顺序组装。
### g关键点

+ 重叠

字节流小块是有重叠的，甚至会包含，开始我以为像教材上一样，只会失序，而不会重叠（怪自己没好好看指导书），这是最关键的地方，也是最难解决的地方，解决好重叠这个关键点，实验思路基本理清

+ 数据结构

第二个是数据结构的选取，我开始选择的是链表，使用插入排序使得index有序，可是后来发现使用map可以使查找时间复杂度降到logn（对cpp不熟悉），果断使用map

### 编码思路

我没有添加辅助方法，所有处理都是实现在push_substring中，特别强大（甚至为实验三省写不少代码）。思路如下：首先对加入的data字符串进行切割，在map中找出和data重叠部分，进行切割，用start和len存储，最后调用sunstr。之后看是否能够写入_output能则写入，之后在map中弹出最小index直至不能加入，最后是后处理。具体步骤如下：
+ start：data子串的开始index
+ len：子串长度




+ 流程：
    + 对传入的data，在map中找上界up
      + 找到，判断是否交叉，交叉则判断是否被包围，包围则结束，否则修改start为up->first+up->second.size()-index;
      + 没有找到，判断index是否<=hope_to_rec,是则进行相应剪切和丢弃；
      
    + 在map中找下届down
      + 找到，判断是否交叉，交叉则判断是否包围，包围则删除down，继续2，否则修改len为down->first-start;否则直接插入，结束；
      + 没有找到，判断start是否越界，越界则丢弃，结束，否则插入map，结束；
      
    + 进行判断是否能写入_output，能则写入，判断是否全部写入，没有则将剩余插入map
    
    +若成功写入且缓冲区未溢出，则在map中拿出第一个尝试写入，能则重复
  
    +求eof_idx，若满足eof_idx<=hope_to_rec则结束写入






   


